@model PROG6212p3.Models.Claim

@{
    ViewBag.Title = "Submit Claim";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Submit Claim</h2>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success">@TempData["Success"]</div>
}

<form asp-action="Claims" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label asp-for="HoursWorked">Hours Worked</label>
        <input asp-for="HoursWorked" class="form-control" id="hoursWorked" type="number" min="1" max="180" />
        <span asp-validation-for="HoursWorked" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="HourlyRate">Hourly Rate</label>
        <input asp-for="HourlyRate" class="form-control" id="hourlyRate" type="number" readonly />
    </div>

    <div class="form-group">
        <label asp-for="Total">Total Payment</label>
        <input asp-for="Total" class="form-control" id="total" type="number" readonly />
    </div>

    <div class="form-group">
        <label>Upload Supporting Document</label>
        <input type="file" name="document" class="form-control" />
        <span asp-validation-for="DocumentPath" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary mt-2">Submit Claim</button>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        const hoursInput = document.getElementById('hoursWorked');
        const rateInput = document.getElementById('hourlyRate');
        const totalInput = document.getElementById('total');

        function updateTotal() {
            const hours = parseFloat(hoursInput.value) || 0;
            const rate = parseFloat(rateInput.value) || 0;
            totalInput.value = (hours * rate).toFixed(2);
        }

        // Update total whenever hours change
        hoursInput.addEventListener('input', updateTotal);

        // Set initial total on page load
        updateTotal();
    </script>
}
